#!/usr/bin/env python3
"""
–£–õ–¨–¢–†–ê-–ö–û–ú–ü–õ–ï–ö–°–ù–ê–Ø –ë–ê–ó–ê –ó–ù–ê–ù–ò–ô –¥–ª—è BearingsInfo
–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ 100% –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ —Å –ø–æ–ª–Ω—ã–º –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º –≤—Å–µ—Ö —Ä–∞–∑–¥–µ–ª–æ–≤
"""

import os
import re
from pathlib import Path
from datetime import datetime
from typing import Dict, List
from collections import defaultdict

class UltraComprehensiveKB:
    def __init__(self, root_dir: str = "."):
        self.root_dir = Path(root_dir)
        self.all_files = {}  # –ü–æ–ª–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤
        self.stats = {
            'files': 0,
            'lines': 0,
            'terms': 0,
            'tables': 0,
            'standards': 0
        }
        
    def load_all_markdown_files(self):
        """–ó–∞–≥—Ä—É–∑–∫–∞ –í–°–ï–• markdown —Ñ–∞–π–ª–æ–≤ —Å –ø–æ–ª–Ω—ã–º —Å–æ–¥–µ—Ä–∂–∏–º—ã–º"""
        priority_dirs = [
            '02_–¢–µ—Ä–º–∏–Ω—ã_–∏_–æ—Å–Ω–æ–≤—ã',
            '03_–ì–û–°–¢_–ø–æ–¥—à–∏–ø–Ω–∏–∫–∏_–∏_–Ω–æ—Ä–º–∞—Ç–∏–≤–∫–∞',
            '–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ_—Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞',
            '–ü–æ–¥—à–∏–ø–Ω–∏–∫–∏',
            '05_–ú–∞—Ä–∫–∏—Ä–æ–≤–∫–∞_—Å—É—Ñ—Ñ–∏–∫—Å—ã_—Å–µ—Ä–∏–∏',
            '04_ISO_–∏_–º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–µ_–æ–±–æ–∑–Ω–∞—á–µ–Ω–∏—è',
            'docs',
            '07_–ë—Ä–µ–Ω–¥—ã_–∏_–∫–∞—Ç–∞–ª–æ–≥–∏',
            '06_–ê–Ω–∞–ª–æ–≥–∏_–∏_–≤–∑–∞–∏–º–æ–∑–∞–º–µ–Ω—è–µ–º–æ—Å—Ç—å',
            '08_–ê–≤—Ç–æ–º–æ–±–∏–ª—å–Ω—ã–µ_–∫–æ–º–ø–ª–µ–∫—Ç—ã',
            '09_–õ–∏–Ω–µ–π–Ω—ã–µ_—Å–∏—Å—Ç–µ–º—ã_–∏_–ø–µ—Ä–µ–¥–∞—á–∏',
            '–£—á–µ–±–Ω–∏–∫',
            '–£—á–µ–±–Ω–∏–∫_–ê–∫–∞–¥–µ–º–∏—á–µ—Å–∫–∏–π',
            '–í–≤–æ–¥–Ω—ã–π_–∫—É—Ä—Å_–¥–ª—è_–Ω–æ–≤–∏—á–∫–æ–≤',
            '10_–†–µ–º–Ω–∏_—à–∫–∏–≤—ã_—Ü–µ–ø–∏',
            '11_–†–¢–ò_—Ä—É–∫–∞–≤–∞_—É–ø–ª–æ—Ç–Ω–µ–Ω–∏—è'
        ]
        
        for dir_name in priority_dirs:
            dir_path = self.root_dir / dir_name
            if dir_path.exists():
                print(f"üìÅ –ó–∞–≥—Ä—É–∑–∫–∞: {dir_name}")
                for md_file in dir_path.rglob('*.md'):
                    try:
                        with open(md_file, 'r', encoding='utf-8') as f:
                            content = f.read()
                        
                        rel_path = str(md_file.relative_to(self.root_dir))
                        self.all_files[rel_path] = content
                        self.stats['files'] += 1
                        self.stats['lines'] += len(content.split('\n'))
                        
                    except Exception as e:
                        print(f"  ‚ö†Ô∏è  –û—à–∏–±–∫–∞ {md_file}: {e}")
                        
        print(f"\n‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ —Ñ–∞–π–ª–æ–≤: {self.stats['files']}")
        print(f"‚úÖ –í—Å–µ–≥–æ —Å—Ç—Ä–æ–∫: {self.stats['lines']:,}\n")
        
    def extract_all_terms(self) -> List[Dict]:
        """–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –í–°–ï–• —Ç–µ—Ä–º–∏–Ω–æ–≤ –∏–∑ –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤"""
        all_terms = []
        
        for path, content in self.all_files.items():
            # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–µ—Ä–º–∏–Ω–æ–≤ (—Å—Ç—Ä–æ–∫–∏ –≤–∏–¥–∞ "**–¢–µ—Ä–º–∏–Ω** - –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ")
            definitions = re.findall(r'\*\*([^*]+)\*\*\s*[-‚Äì‚Äî]\s*(.+?)(?:\n|$)', content)
            for term, definition in definitions:
                all_terms.append({
                    'term': term.strip(),
                    'definition': definition.strip()[:200],
                    'source': path,
                    'type': 'definition'
                })
            
            # –ó–∞–≥–æ–ª–æ–≤–∫–∏ –∫–∞–∫ —Ç–µ—Ä–º–∏–Ω—ã
            headers = re.findall(r'^#{1,4}\s+(.+)$', content, re.MULTILINE)
            for header in headers:
                if len(header) < 100:  # –†–∞–∑—É–º–Ω–∞—è –¥–ª–∏–Ω–∞
                    all_terms.append({
                        'term': header.strip(),
                        'definition': '',
                        'source': path,
                        'type': 'header'
                    })
                    
        self.stats['terms'] = len(all_terms)
        return all_terms
        
    def extract_all_tables(self) -> List[Dict]:
        """–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –í–°–ï–• —Ç–∞–±–ª–∏—Ü"""
        all_tables = []
        
        for path, content in self.all_files.items():
            lines = content.split('\n')
            current_table = []
            table_context = ""
            
            for i, line in enumerate(lines):
                # –ö–æ–Ω—Ç–µ–∫—Å—Ç –ø–µ—Ä–µ–¥ —Ç–∞–±–ª–∏—Ü–µ–π (–∑–∞–≥–æ–ª–æ–≤–æ–∫)
                if line.startswith('#') and not current_table:
                    table_context = line.strip()
                    
                if '|' in line and line.strip():
                    current_table.append(line)
                elif current_table and len(current_table) > 2:  # –ú–∏–Ω–∏–º—É–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ + —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å + 1 —Å—Ç—Ä–æ–∫–∞
                    all_tables.append({
                        'context': table_context,
                        'content': '\n'.join(current_table),
                        'source': path,
                        'rows': len(current_table) - 2  # –ú–∏–Ω—É—Å –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∏ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å
                    })
                    current_table = []
                    table_context = ""
                elif current_table:
                    current_table = []
                    
        self.stats['tables'] = len(all_tables)
        return all_tables
        
    def extract_all_standards(self) -> List[Dict]:
        """–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –í–°–ï–• —É–ø–æ–º–∏–Ω–∞–Ω–∏–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–≤"""
        all_standards = []
        
        for path, content in self.all_files.items():
            # –ì–û–°–¢
            for match in re.finditer(r'(–ì–û–°–¢\s+\d+(?:\.\d+)?(?:\-\d+)?)', content):
                all_standards.append({
                    'standard': match.group(1),
                    'type': '–ì–û–°–¢',
                    'source': path,
                    'context': content[max(0, match.start()-100):match.end()+100]
                })
                
            # ISO
            for match in re.finditer(r'(ISO\s+\d+(?:\-\d+)?(?:\:\d+)?)', content):
                all_standards.append({
                    'standard': match.group(1),
                    'type': 'ISO',
                    'source': path,
                    'context': content[max(0, match.start()-100):match.end()+100]
                })
                
            # DIN
            for match in re.finditer(r'(DIN\s+\d+(?:\-\d+)?)', content):
                all_standards.append({
                    'standard': match.group(1),
                    'type': 'DIN',
                    'source': path,
                    'context': content[max(0, match.start()-100):match.end()+100]
                })
                
        self.stats['standards'] = len(all_standards)
        return all_standards
        
    def build_section_1_domain(self) -> str:
        """–†–∞–∑–¥–µ–ª 1: –ü–û–õ–ù–û–ï –æ–ø–∏—Å–∞–Ω–∏–µ –¥–æ–º–µ–Ω–∞"""
        lines = []
        lines.append("### 1.1. –ü—Ä–µ–¥–º–µ—Ç–Ω–∞—è –æ–±–ª–∞—Å—Ç—å")
        lines.append("\n–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π BearingsInfo - –∏—Å—á–µ—Ä–ø—ã–≤–∞—é—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø–æ –ø–æ–¥—à–∏–ø–Ω–∏–∫–∞–º –∫–∞—á–µ–Ω–∏—è")
        lines.append("–∏ —Å–æ–ø—É—Ç—Å—Ç–≤—É—é—â–∏–º –∏–∑–¥–µ–ª–∏—è–º. –û—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç —Ç–µ–æ—Ä–∏—é, –ø—Ä–∞–∫—Ç–∏–∫—É, —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã, –∫–∞—Ç–∞–ª–æ–≥–∏.\n")
        
        lines.append("### 1.2. –ö–ª—é—á–µ–≤—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–æ–¥—à–∏–ø–Ω–∏–∫–æ–≤\n")
        lines.append("#### –ü–æ–¥—à–∏–ø–Ω–∏–∫–∏ –∫–∞—á–µ–Ω–∏—è")
        lines.append("- **–®–∞—Ä–∏–∫–æ–≤—ã–µ** - –∏—Å–ø–æ–ª—å–∑—É—é—Ç —à–∞—Ä–∏–∫–∏ –∫–∞–∫ —Ç–µ–ª–∞ –∫–∞—á–µ–Ω–∏—è")
        lines.append("  - –†–∞–¥–∏–∞–ª—å–Ω—ã–µ –æ–¥–Ω–æ—Ä—è–¥–Ω—ã–µ")
        lines.append("  - –†–∞–¥–∏–∞–ª—å–Ω–æ-—É–ø–æ—Ä–Ω—ã–µ")
        lines.append("  - –£–ø–æ—Ä–Ω—ã–µ")
        lines.append("- **–†–æ–ª–∏–∫–æ–≤—ã–µ** - –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ä–æ–ª–∏–∫–∏")
        lines.append("  - –¶–∏–ª–∏–Ω–¥—Ä–∏—á–µ—Å–∫–∏–µ")
        lines.append("  - –ö–æ–Ω–∏—á–µ—Å–∫–∏–µ")
        lines.append("  - –ò–≥–æ–ª—å—á–∞—Ç—ã–µ")
        lines.append("  - –°—Ñ–µ—Ä–∏—á–µ—Å–∫–∏–µ (—Å–∞–º–æ—É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—â–∏–µ—Å—è)\n")
        
        lines.append("#### –ü–æ–¥—à–∏–ø–Ω–∏–∫–∏ —Å–∫–æ–ª—å–∂–µ–Ω–∏—è")
        lines.append("- –í—Ç—É–ª–∫–∏")
        lines.append("- –°—Ñ–µ—Ä–∏—á–µ—Å–∫–∏–µ —à–∞—Ä–Ω–∏—Ä–Ω—ã–µ")
        lines.append("- –£–ø–æ—Ä–Ω—ã–µ —Å–∫–æ–ª—å–∂–µ–Ω–∏—è\n")
        
        lines.append("### 1.3. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è\n")
        
        # –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
        structure_desc = [
            ("02_–¢–µ—Ä–º–∏–Ω—ã_–∏_–æ—Å–Ω–æ–≤—ã", "–§—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è —Ç–µ–æ—Ä–∏—è, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è, —Ç–∏–ø–æ–ª–æ–≥–∏—è"),
            ("03_–ì–û–°–¢_–ø–æ–¥—à–∏–ø–Ω–∏–∫–∏_–∏_–Ω–æ—Ä–º–∞—Ç–∏–≤–∫–∞", "–†–æ—Å—Å–∏–π—Å–∫–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã –ì–û–°–¢"),
            ("04_ISO_–∏_–º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–µ_–æ–±–æ–∑–Ω–∞—á–µ–Ω–∏—è", "–ú–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã ISO, DIN, JIS"),
            ("05_–ú–∞—Ä–∫–∏—Ä–æ–≤–∫–∞_—Å—É—Ñ—Ñ–∏–∫—Å—ã_—Å–µ—Ä–∏–∏", "–°–∏—Å—Ç–µ–º—ã –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–µ–π"),
            ("–ü–æ–¥—à–∏–ø–Ω–∏–∫–∏", "–î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ —Ç–∏–ø–∞–º –ø–æ–¥—à–∏–ø–Ω–∏–∫–æ–≤"),
            ("–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ_—Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞", "–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—é, –º–æ–Ω—Ç–∞–∂—É, –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—é"),
            ("07_–ë—Ä–µ–Ω–¥—ã_–∏_–∫–∞—Ç–∞–ª–æ–≥–∏", "–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–∏, –±—Ä–µ–Ω–¥—ã, –∫–∞—Ç–∞–ª–æ–≥–∏"),
            ("06_–ê–Ω–∞–ª–æ–≥–∏_–∏_–≤–∑–∞–∏–º–æ–∑–∞–º–µ–Ω—è–µ–º–æ—Å—Ç—å", "–¢–∞–±–ª–∏—Ü—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –∏ –∑–∞–º–µ–Ω—ã"),
            ("08_–ê–≤—Ç–æ–º–æ–±–∏–ª—å–Ω—ã–µ_–∫–æ–º–ø–ª–µ–∫—Ç—ã", "–°—Ç—É–ø–∏—á–Ω—ã–µ –ø–æ–¥—à–∏–ø–Ω–∏–∫–∏ –¥–ª—è –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π"),
            ("09_–õ–∏–Ω–µ–π–Ω—ã–µ_—Å–∏—Å—Ç–µ–º—ã_–∏_–ø–µ—Ä–µ–¥–∞—á–∏", "–®–í–ü, –Ω–∞–ø—Ä–∞–≤–ª—è—é—â–∏–µ, –ª–∏–Ω–µ–π–Ω—ã–µ –ø–æ–¥—à–∏–ø–Ω–∏–∫–∏"),
            ("10_–†–µ–º–Ω–∏_—à–∫–∏–≤—ã_—Ü–µ–ø–∏", "–ü–µ—Ä–µ–¥–∞—á–∏ —Ä–µ–º–µ–Ω–Ω—ã–µ –∏ —Ü–µ–ø–Ω—ã–µ"),
            ("11_–†–¢–ò_—Ä—É–∫–∞–≤–∞_—É–ø–ª–æ—Ç–Ω–µ–Ω–∏—è", "–£–ø–ª–æ—Ç–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏–∑–¥–µ–ª–∏—è"),
            ("docs", "–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ —Å—Ç–∞—Ç—å–∏"),
            ("–£—á–µ–±–Ω–∏–∫", "–û–±—É—á–∞—é—â–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã"),
            ("–í–≤–æ–¥–Ω—ã–π_–∫—É—Ä—Å_–¥–ª—è_–Ω–æ–≤–∏—á–∫–æ–≤", "–ú–∞—Ç–µ—Ä–∏–∞–ª—ã –¥–ª—è –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö")
        ]
        
        for dir_name, description in structure_desc:
            dir_path = self.root_dir / dir_name
            if dir_path.exists():
                file_count = len(list(dir_path.rglob('*.md')))
                lines.append(f"- **{dir_name}** ({file_count} —Ñ–∞–π–ª–æ–≤) - {description}")
                
        lines.append(f"\n### 1.4. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞")
        lines.append(f"- –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ —Ñ–∞–π–ª–æ–≤: **{self.stats['files']}**")
        lines.append(f"- –°—Ç—Ä–æ–∫ –∫–æ–¥–∞/—Ç–µ–∫—Å—Ç–∞: **{self.stats['lines']:,}**")
        lines.append(f"- –ò–∑–≤–ª–µ—á–µ–Ω–æ —Ç–µ—Ä–º–∏–Ω–æ–≤: **{self.stats['terms']:,}**")
        lines.append(f"- –¢–∞–±–ª–∏—Ü –¥–∞–Ω–Ω—ã—Ö: **{self.stats['tables']}**")
        lines.append(f"- –£–ø–æ–º–∏–Ω–∞–Ω–∏–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–≤: **{self.stats['standards']}**\n")
        
        return '\n'.join(lines)
        
    def build_section_2_terms(self, all_terms: List[Dict]) -> str:
        """–†–∞–∑–¥–µ–ª 2: –ü–û–õ–ù–´–ô –≥–ª–æ—Å—Å–∞—Ä–∏–π"""
        lines = []
        lines.append("### 2.1. –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ—Ä–º–∏–Ω—ã –∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è\n")
        
        # –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ —Ç–µ—Ä–º–∏–Ω–æ–≤ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
        by_source_dir = defaultdict(list)
        for term in all_terms:
            source_dir = term['source'].split('/')[0]
            by_source_dir[source_dir].append(term)
            
        lines.append("#### –¢–µ—Ä–º–∏–Ω—ã –ø–æ —Ä–∞–∑–¥–µ–ª–∞–º\n")
        
        for source_dir in sorted(by_source_dir.keys()):
            terms_list = by_source_dir[source_dir]
            lines.append(f"\n##### {source_dir} ({len(terms_list)} —Ç–µ—Ä–º–∏–Ω–æ–≤)\n")
            lines.append("| –¢–µ—Ä–º–∏–Ω | –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ | –ò—Å—Ç–æ—á–Ω–∏–∫ |")
            lines.append("|--------|-------------|----------|")
            
            # –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Ç–µ—Ä–º–∏–Ω—ã
            seen = set()
            for term_data in terms_list[:200]:  # –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–ª—è —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏
                term = term_data['term']
                if term not in seen and len(term) > 2:
                    seen.add(term)
                    definition = term_data['definition'][:100] if term_data['definition'] else ""
                    source = term_data['source'].replace('|', '/')
                    lines.append(f"| {term} | {definition} | `{source}` |")
                    
        lines.append(f"\n**–í—Å–µ–≥–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Ç–µ—Ä–º–∏–Ω–æ–≤: {len(set(t['term'] for t in all_terms))}**\n")
        return '\n'.join(lines)
        
    def build_section_3_processes(self) -> str:
        """–†–∞–∑–¥–µ–ª 3: –ü–û–õ–ù–´–ï –ø—Ä–æ—Ü–µ—Å—Å—ã –∏ –∞–ª–≥–æ—Ä–∏—Ç–º—ã"""
        lines = []
        lines.append("### 3.1. –ü—Ä–æ—Ü–µ—Å—Å—ã –∂–∏–∑–Ω–µ–Ω–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ –ø–æ–¥—à–∏–ø–Ω–∏–∫–æ–≤\n")
        
        # –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ —Å –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏
        process_files = [
            ('–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ_—Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞/10_–ú–æ–Ω—Ç–∞–∂_–ø–æ–¥—à–∏–ø–Ω–∏–∫–∞.md', '–ú–æ–Ω—Ç–∞–∂ –ø–æ–¥—à–∏–ø–Ω–∏–∫–∞'),
            ('–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ_—Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞/11_–î–µ–º–æ–Ω—Ç–∞–∂_–ø–æ–¥—à–∏–ø–Ω–∏–∫–∞.md', '–î–µ–º–æ–Ω—Ç–∞–∂ –ø–æ–¥—à–∏–ø–Ω–∏–∫–∞'),
            ('–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ_—Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞/12_–û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ_–ø–æ–¥—à–∏–ø–Ω–∏–∫–∞.md', '–û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ'),
            ('–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ_—Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞/13_–°–º–∞–∑–∫–∞_–ø–æ–¥—à–∏–ø–Ω–∏–∫–æ–≤.md', '–°–º–∞–∑–∫–∞'),
            ('–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ_—Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞/14_–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞_–ø–æ–¥—à–∏–ø–Ω–∏–∫–æ–≤.md', '–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞'),
            ('–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ_—Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞/15_–•—Ä–∞–Ω–µ–Ω–∏–µ_–ø–æ–¥—à–∏–ø–Ω–∏–∫–æ–≤.md', '–•—Ä–∞–Ω–µ–Ω–∏–µ'),
            ('–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ_—Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞/16_–ü—Ä–∏–µ–º–∫–∞_–ø–æ–¥—à–∏–ø–Ω–∏–∫–æ–≤.md', '–ü—Ä–∏—ë–º–∫–∞'),
            ('–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ_—Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞/03_–ò–∑–º–µ—Ä–µ–Ω–∏–µ_–ø–æ–¥—à–∏–ø–Ω–∏–∫–∞.md', '–ò–∑–º–µ—Ä–µ–Ω–∏–µ'),
        ]
        
        for file_path, title in process_files:
            if file_path in self.all_files:
                lines.append(f"\n#### {title}\n")
                lines.append(f"**–ò—Å—Ç–æ—á–Ω–∏–∫:** `{file_path}`\n")
                
                content = self.all_files[file_path]
                # –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ä–∞–∑–¥–µ–ª–æ–≤
                sections = re.split(r'\n##\s+', content)
                for section in sections[:5]:  # –ü–µ—Ä–≤—ã–µ 5 —Ä–∞–∑–¥–µ–ª–æ–≤
                    if section.strip():
                        lines.append(section.strip()[:1500])  # –ü–µ—Ä–≤—ã–µ 1500 —Å–∏–º–≤–æ–ª–æ–≤
                        lines.append("\n...")
                        lines.append("")
                        
        return '\n'.join(lines)
        
    def build_section_4_rules(self, all_standards: List[Dict]) -> str:
        """–†–∞–∑–¥–µ–ª 4: –ü–û–õ–ù–´–ï –ø—Ä–∞–≤–∏–ª–∞ –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã"""
        lines = []
        lines.append("### 4.1. –°—Ç–∞–Ω–¥–∞—Ä—Ç—ã –∏ –Ω–æ—Ä–º–∞—Ç–∏–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è\n")
        
        # –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ —Ç–∏–ø–∞–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–≤
        by_type = defaultdict(list)
        for std in all_standards:
            by_type[std['type']].append(std)
            
        for std_type in sorted(by_type.keys()):
            standards_list = by_type[std_type]
            unique_stds = {}
            
            for std_data in standards_list:
                std_name = std_data['standard']
                if std_name not in unique_stds:
                    unique_stds[std_name] = []
                unique_stds[std_name].append(std_data['source'])
                
            lines.append(f"\n#### –°—Ç–∞–Ω–¥–∞—Ä—Ç—ã {std_type} ({len(unique_stds)} —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö)\n")
            lines.append("| –°—Ç–∞–Ω–¥–∞—Ä—Ç | –ò—Å—Ç–æ—á–Ω–∏–∫–∏ (–ø—Ä–∏–º–µ—Ä—ã) |")
            lines.append("|----------|---------------------|")
            
            for std_name in sorted(unique_stds.keys())[:100]:
                sources = ', '.join(list(set(unique_stds[std_name]))[:3])
                lines.append(f"| **{std_name}** | `{sources}` |")
                
        # –î–µ—Ç–∞–ª—å–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –ì–û–°–¢–∞
        lines.append("\n### 4.2. –î–µ—Ç–∞–ª—å–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –Ω–æ—Ä–º–∞—Ç–∏–≤–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤\n")
        
        gost_files = [path for path in self.all_files.keys() if '–ì–û–°–¢' in path or '03_–ì–û–°–¢' in path]
        for gost_file in gost_files[:20]:
            lines.append(f"\n#### {gost_file}\n")
            content = self.all_files[gost_file]
            lines.append(content[:2000])  # –ü–µ—Ä–≤—ã–µ 2000 —Å–∏–º–≤–æ–ª–æ–≤
            lines.append("\n...\n")
            
        return '\n'.join(lines)
        
    def build_section_5_data_structures(self, all_tables: List[Dict]) -> str:
        """–†–∞–∑–¥–µ–ª 5: –í–°–ï —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö"""
        lines = []
        lines.append("### 5.1. –¢–∞–±–ª–∏—Ü—ã —Ä–∞–∑–º–µ—Ä–æ–≤ –∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫\n")
        lines.append(f"**–í—Å–µ–≥–æ —Ç–∞–±–ª–∏—Ü –≤ –±–∞–∑–µ: {len(all_tables)}**\n")
        
        # –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º
        by_source = defaultdict(list)
        for table in all_tables:
            by_source[table['source']].append(table)
            
        lines.append("#### –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü –ø–æ —Ä–∞–∑–¥–µ–ª–∞–º\n")
        lines.append("| –†–∞–∑–¥–µ–ª | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–∞–±–ª–∏—Ü |")
        lines.append("|--------|-------------------|")
        
        section_counts = defaultdict(int)
        for source in by_source.keys():
            section = source.split('/')[0]
            section_counts[section] += len(by_source[source])
            
        for section in sorted(section_counts.keys()):
            lines.append(f"| {section} | {section_counts[section]} |")
            
        # –ü—Ä–∏–º–µ—Ä—ã —Ç–∞–±–ª–∏—Ü
        lines.append("\n### 5.2. –ü—Ä–∏–º–µ—Ä—ã —Ç–∞–±–ª–∏—Ü –¥–∞–Ω–Ω—ã—Ö\n")
        
        shown_count = 0
        for source in sorted(by_source.keys()):
            if shown_count >= 50:
                break
                
            tables = by_source[source]
            lines.append(f"\n#### –ò—Å—Ç–æ—á–Ω–∏–∫: `{source}`\n")
            
            for table in tables[:3]:  # –ü–µ—Ä–≤—ã–µ 3 —Ç–∞–±–ª–∏—Ü—ã –∏–∑ —Ñ–∞–π–ª–∞
                if table['context']:
                    lines.append(f"**–ö–æ–Ω—Ç–µ–∫—Å—Ç:** {table['context']}\n")
                lines.append(table['content'])
                lines.append("")
                shown_count += 1
                
                if shown_count >= 50:
                    break
                    
        return '\n'.join(lines)
        
    def build_section_6_roles(self) -> str:
        """–†–∞–∑–¥–µ–ª 6: –†–æ–ª–∏ –∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏"""
        lines = []
        lines.append("### 6.1. –£—á–∞—Å—Ç–Ω–∏–∫–∏ –∂–∏–∑–Ω–µ–Ω–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ –ø–æ–¥—à–∏–ø–Ω–∏–∫–æ–≤\n")
        
        roles = {
            "–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–∏ –ø–æ–¥—à–∏–ø–Ω–∏–∫–æ–≤": [
                "–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ –ø–æ–¥—à–∏–ø–Ω–∏–∫–æ–≤",
                "–ö–æ–Ω—Ç—Ä–æ–ª—å –∫–∞—á–µ—Å—Ç–≤–∞ –Ω–∞ –≤—Å–µ—Ö —ç—Ç–∞–ø–∞—Ö",
                "–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø—Ä–æ–¥—É–∫—Ü–∏–∏ (ISO 9001, ISO/TS 16949)",
                "–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ –∫–∞—Ç–∞–ª–æ–≥–∏",
                "–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤",
                "–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –Ω–æ–≤—ã—Ö —Ç–∏–ø–æ–≤",
                "–ü—Ä–∏–º–µ—Ä—ã: SKF, NSK, FAG, NTN, Timken, INA, KOYO"
            ],
            "–î–∏—Å—Ç—Ä–∏–±—å—é—Ç–æ—Ä—ã –∏ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∏": [
                "–õ–æ–≥–∏—Å—Ç–∏–∫–∞ –∏ —Å–∫–ª–∞–¥—Å–∫–æ–µ —Ö–æ–∑—è–π—Å—Ç–≤–æ",
                "–ü–æ–¥–±–æ—Ä –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤",
                "–ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ –ø–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—é",
                "–ü–æ–¥–±–æ—Ä –∞–Ω–∞–ª–æ–≥–æ–≤ –∏ –∑–∞–º–µ–Ω–∏—Ç–µ–ª–µ–π",
                "–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –ø–æ—Å—Ç–∞–≤–æ–∫ '—Ç–æ—á–Ω–æ –≤ —Å—Ä–æ–∫'",
                "–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å–µ—Ä–≤–∏—Å –∏ –æ–±—É—á–µ–Ω–∏–µ",
                "–ì–∞—Ä–∞–Ω—Ç–∏—è –Ω–∞ –ø–æ—Å—Ç–∞–≤–ª—è–µ–º—É—é –ø—Ä–æ–¥—É–∫—Ü–∏—é"
            ],
            "–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä—ã –∏ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤—â–∏–∫–∏": [
                "–í—ã–±–æ—Ä —Ç–∏–ø–∞ –∏ —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–¥—à–∏–ø–Ω–∏–∫–∞",
                "–†–∞—Å—á—ë—Ç –¥–æ–ª–≥–æ–≤–µ—á–Ω–æ—Å—Ç–∏ –∏ –≥—Ä—É–∑–æ–ø–æ–¥—ä—ë–º–Ω–æ—Å—Ç–∏",
                "–ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥—à–∏–ø–Ω–∏–∫–æ–≤—ã—Ö —É–∑–ª–æ–≤",
                "–í—ã–±–æ—Ä –ø–æ—Å–∞–¥–æ–∫ –∏ –∑–∞–∑–æ—Ä–æ–≤",
                "–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Å–∏—Å—Ç–µ–º —Å–º–∞–∑–∫–∏",
                "–ê–Ω–∞–ª–∏–∑ —É—Å–ª–æ–≤–∏–π —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏",
                "–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è —Å–Ω–∏–∂–µ–Ω–∏—è —Å—Ç–æ–∏–º–æ—Å—Ç–∏",
                "CAD-–º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —É–∑–ª–æ–≤"
            ],
            "–¢–µ—Ö–Ω–æ–ª–æ–≥–∏ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–∏–∫–∏": [
                "–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –º–æ–Ω—Ç–∞–∂–∞",
                "–í—ã–±–æ—Ä –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è –¥–ª—è –∑–∞–ø—Ä–µ—Å—Å–æ–≤–∫–∏",
                "–ö–æ–Ω—Ç—Ä–æ–ª—å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–æ—Å–∞–¥–∫–∏",
                "–í—Ö–æ–¥–Ω–æ–π –∫–æ–Ω—Ç—Ä–æ–ª—å –ø–æ–¥—à–∏–ø–Ω–∏–∫–æ–≤",
                "–•—Ä–∞–Ω–µ–Ω–∏–µ –¥–æ —É—Å—Ç–∞–Ω–æ–≤–∫–∏",
                "–û–±–µ—Å–ø–µ—á–µ–Ω–∏–µ —á–∏—Å—Ç–æ—Ç—ã –ø—Ä–∏ –º–æ–Ω—Ç–∞–∂–µ"
            ],
            "–≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–æ–Ω–Ω—ã–π –ø–µ—Ä—Å–æ–Ω–∞–ª": [
                "–ú–æ–Ω—Ç–∞–∂ –∏ –¥–µ–º–æ–Ω—Ç–∞–∂ –ø–æ–¥—à–∏–ø–Ω–∏–∫–æ–≤",
                "–†–µ–≥—É–ª—è—Ä–Ω–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –∏ —Å–º–∞–∑–∫–∞",
                "–í–∏–±—Ä–æ–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥",
                "–í—ã—è–≤–ª–µ–Ω–∏–µ —Ä–∞–Ω–Ω–∏—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏–∑–Ω–æ—Å–∞",
                "–ü–ª–∞–Ω–æ–≤–∞—è –∑–∞–º–µ–Ω–∞",
                "–í–µ–¥–µ–Ω–∏–µ –∂—É—Ä–Ω–∞–ª–æ–≤ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è",
                "–°–æ–±–ª—é–¥–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤ –¢–û"
            ],
            "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç—ã –ø–æ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–µ": [
                "–í–∏–±—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞",
                "–¢–µ—Ä–º–æ–≥—Ä–∞—Ñ–∏—è –ø–æ–¥—à–∏–ø–Ω–∏–∫–æ–≤—ã—Ö —É–∑–ª–æ–≤",
                "–ê–Ω–∞–ª–∏–∑ —Å–º–∞–∑–∫–∏ (—Ç—Ä–∏–±–æ—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑)",
                "–ê–∫—É—Å—Ç–∏—á–µ—Å–∫–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞",
                "–ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Å—Ç–∞—Ç–æ—á–Ω–æ–≥–æ —Ä–µ—Å—É—Ä—Å–∞",
                "–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∑–∞–º–µ–Ω–µ"
            ]
        }
        
        for role, responsibilities in roles.items():
            lines.append(f"\n#### {role}\n")
            for resp in responsibilities:
                lines.append(f"- {resp}")
            lines.append("")
            
        return '\n'.join(lines)
        
    def build_section_7_usage(self) -> str:
        """–†–∞–∑–¥–µ–ª 7: –ü–û–õ–ù–´–ï –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∏ —Å—Ü–µ–Ω–∞—Ä–∏–∏"""
        lines = []
        lines.append("### 7.1. –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è\n")
        
        # –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –≤—Å–µ—Ö –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤
        practical_files = [path for path in self.all_files.keys() 
                          if '–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ' in path or '—Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤' in path]
        
        for i, file_path in enumerate(sorted(practical_files)[:30], 1):
            lines.append(f"\n#### {i}. {Path(file_path).stem}\n")
            lines.append(f"**–ò—Å—Ç–æ—á–Ω–∏–∫:** `{file_path}`\n")
            
            content = self.all_files[file_path]
            # –ü–æ–ª–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ (–¥–æ 3000 —Å–∏–º–≤–æ–ª–æ–≤)
            lines.append(content[:3000])
            if len(content) > 3000:
                lines.append("\n... (–ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –≤ –∏—Å—Ö–æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ)\n")
            lines.append("\n" + "="*80 + "\n")
            
        return '\n'.join(lines)
        
    def build_section_8_errors(self) -> str:
        """–†–∞–∑–¥–µ–ª 8: –û—à–∏–±–∫–∏ –∏ –∏—Å–∫–ª—é—á–µ–Ω–∏—è"""
        lines = []
        lines.append("### 8.1. –¢–∏–ø–æ–≤—ã–µ –Ω–µ–∏—Å–ø—Ä–∞–≤–Ω–æ—Å—Ç–∏ –ø–æ–¥—à–∏–ø–Ω–∏–∫–æ–≤\n")
        
        # –ü–æ–∏—Å–∫ —Ñ–∞–π–ª–æ–≤ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ–± –æ—Ç–∫–∞–∑–∞—Ö
        failure_files = [path for path in self.all_files.keys() 
                        if any(kw in path.lower() for kw in ['–æ—Ç–∫–∞–∑', '–Ω–µ–∏—Å–ø—Ä–∞–≤–Ω–æ—Å—Ç', '–¥–µ—Ñ–µ–∫—Ç', '–ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏', '–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞', 'failure'])]
        
        for file_path in failure_files[:15]:
            lines.append(f"\n#### –ò—Å—Ç–æ—á–Ω–∏–∫: `{file_path}`\n")
            content = self.all_files[file_path]
            lines.append(content[:2500])
            lines.append("\n...\n")
            
        # –¢–∏–ø–æ–≤—ã–µ –≤–∏–¥—ã –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–π
        lines.append("\n### 8.2. –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–π\n")
        
        damage_types = {
            "–£—Å—Ç–∞–ª–æ—Å—Ç–Ω–æ–µ –≤—ã–∫—Ä–∞—à–∏–≤–∞–Ω–∏–µ": [
                "–ü—Ä–∏—á–∏–Ω–∞: –ø—Ä–µ–≤—ã—à–µ–Ω–∏–µ —Ä–∞—Å—á—ë—Ç–Ω–æ–π –¥–æ–ª–≥–æ–≤–µ—á–Ω–æ—Å—Ç–∏",
                "–ü—Ä–∏–∑–Ω–∞–∫: —à–µ–ª—É—à–µ–Ω–∏–µ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏ –¥–æ—Ä–æ–∂–µ–∫ –∫–∞—á–µ–Ω–∏—è",
                "–î–µ–π—Å—Ç–≤–∏–µ: –ø–ª–∞–Ω–æ–≤–∞—è –∑–∞–º–µ–Ω–∞"
            ],
            "–ê–±—Ä–∞–∑–∏–≤–Ω—ã–π –∏–∑–Ω–æ—Å": [
                "–ü—Ä–∏—á–∏–Ω–∞: –ø–æ–ø–∞–¥–∞–Ω–∏–µ –∑–∞–≥—Ä—è–∑–Ω–µ–Ω–∏–π –≤ –ø–æ–¥—à–∏–ø–Ω–∏–∫",
                "–ü—Ä–∏–∑–Ω–∞–∫: –º–∞—Ç–æ–≤–∞—è –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å –¥–æ—Ä–æ–∂–µ–∫",
                "–î–µ–π—Å—Ç–≤–∏–µ: —É–ª—É—á—à–∏—Ç—å —É–ø–ª–æ—Ç–Ω–µ–Ω–∏—è, –æ—á–∏—Å—Ç–∫—É —Å–º–∞–∑–∫–∏"
            ],
            "–ó–∞–¥–∏—Ä—ã –∏ —Ü–∞—Ä–∞–ø–∏–Ω—ã": [
                "–ü—Ä–∏—á–∏–Ω–∞: –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è —Å–º–∞–∑–∫–∞, –ø–µ—Ä–µ–≥—Ä–µ–≤",
                "–ü—Ä–∏–∑–Ω–∞–∫: —Å–ª–µ–¥—ã —Ç—Ä–µ–Ω–∏—è –Ω–∞ –¥–æ—Ä–æ–∂–∫–∞—Ö",
                "–î–µ–π—Å—Ç–≤–∏–µ: –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∏—Å—Ç–µ–º—É —Å–º–∞–∑–∫–∏"
            ],
            "–ö–æ—Ä—Ä–æ–∑–∏—è": [
                "–ü—Ä–∏—á–∏–Ω–∞: –≤–ª–∞–≥–∞, –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–µ —Å—Ä–µ–¥—ã",
                "–ü—Ä–∏–∑–Ω–∞–∫: —Ä–∂–∞–≤—á–∏–Ω–∞, –ø–∏—Ç—Ç–∏–Ω–≥",
                "–î–µ–π—Å—Ç–≤–∏–µ: —É–ª—É—á—à–∏—Ç—å –∑–∞—â–∏—Ç—É, –∑–∞–º–µ–Ω–∏—Ç—å —Å–º–∞–∑–∫—É"
            ],
            "–¢—Ä–µ—â–∏–Ω—ã": [
                "–ü—Ä–∏—á–∏–Ω–∞: —É–¥–∞—Ä–Ω—ã–µ –Ω–∞–≥—Ä—É–∑–∫–∏, –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –º–æ–Ω—Ç–∞–∂",
                "–ü—Ä–∏–∑–Ω–∞–∫: –≤–∏–¥–∏–º—ã–µ —Ç—Ä–µ—â–∏–Ω—ã –Ω–∞ –∫–æ–ª—å—Ü–∞—Ö",
                "–î–µ–π—Å—Ç–≤–∏–µ: –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–∞—è –∑–∞–º–µ–Ω–∞"
            ],
            "–í–º—è—Ç–∏–Ω—ã (–±—Ä–∏–Ω–µ–ª–ª–∏—Ä–æ–≤–∞–Ω–∏–µ)": [
                "–ü—Ä–∏—á–∏–Ω–∞: —É–¥–∞—Ä—ã –ø—Ä–∏ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∫–µ/–º–æ–Ω—Ç–∞–∂–µ",
                "–ü—Ä–∏–∑–Ω–∞–∫: –≤–º—è—Ç–∏–Ω—ã –Ω–∞ –¥–æ—Ä–æ–∂–∫–∞—Ö –∫–∞—á–µ–Ω–∏—è",
                "–î–µ–π—Å—Ç–≤–∏–µ: –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å —É–¥–∞—Ä–Ω—ã–µ –Ω–∞–≥—Ä—É–∑–∫–∏"
            ]
        }
        
        for damage, details in damage_types.items():
            lines.append(f"\n#### {damage}\n")
            for detail in details:
                lines.append(f"- {detail}")
            lines.append("")
            
        return '\n'.join(lines)
        
    def build_section_9_relationships(self) -> str:
        """–†–∞–∑–¥–µ–ª 9: –°–≤—è–∑–∏ –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏"""
        lines = []
        lines.append("### 9.1. –ò–µ—Ä–∞—Ä—Ö–∏—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ–¥—à–∏–ø–Ω–∏–∫–æ–≤\n")
        
        lines.append("```")
        lines.append("–ü–û–î–®–ò–ü–ù–ò–ö–ò")
        lines.append("‚îÇ")
        lines.append("‚îú‚îÄ‚îÄ –ü–û–î–®–ò–ü–ù–ò–ö–ò –ö–ê–ß–ï–ù–ò–Ø")
        lines.append("‚îÇ   ‚îú‚îÄ‚îÄ –®–∞—Ä–∏–∫–æ–≤—ã–µ")
        lines.append("‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ –†–∞–¥–∏–∞–ª—å–Ω—ã–µ –æ–¥–Ω–æ—Ä—è–¥–Ω—ã–µ")
        lines.append("‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ –û—Ç–∫—Ä—ã—Ç—ã–µ")
        lines.append("‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ –° –∑–∞—â–∏—Ç–Ω—ã–º–∏ —à–∞–π–±–∞–º–∏ (Z)")
        lines.append("‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ –° —É–ø–ª–æ—Ç–Ω–µ–Ω–∏—è–º–∏ (2RS)")
        lines.append("‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ –†–∞–¥–∏–∞–ª—å–Ω–æ-—É–ø–æ—Ä–Ω—ã–µ")
        lines.append("‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ –û–¥–Ω–æ—Ä—è–¥–Ω—ã–µ")
        lines.append("‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ –î–≤—É—Ö—Ä—è–¥–Ω—ã–µ")
        lines.append("‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ –£–ø–æ—Ä–Ω—ã–µ")
        lines.append("‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ –°–∞–º–æ—É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—â–∏–µ—Å—è")
        lines.append("‚îÇ   ‚îÇ")
        lines.append("‚îÇ   ‚îî‚îÄ‚îÄ –†–æ–ª–∏–∫–æ–≤—ã–µ")
        lines.append("‚îÇ       ‚îú‚îÄ‚îÄ –¶–∏–ª–∏–Ω–¥—Ä–∏—á–µ—Å–∫–∏–µ")
        lines.append("‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ –û–¥–Ω–æ—Ä—è–¥–Ω—ã–µ (NU, N, NJ)")
        lines.append("‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ –î–≤—É—Ö—Ä—è–¥–Ω—ã–µ (NNU, NN)")
        lines.append("‚îÇ       ‚îú‚îÄ‚îÄ –ö–æ–Ω–∏—á–µ—Å–∫–∏–µ")
        lines.append("‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ –û–¥–Ω–æ—Ä—è–¥–Ω—ã–µ")
        lines.append("‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ –î–≤—É—Ö—Ä—è–¥–Ω—ã–µ")
        lines.append("‚îÇ       ‚îú‚îÄ‚îÄ –ò–≥–æ–ª—å—á–∞—Ç—ã–µ")
        lines.append("‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ –° —Å–µ–ø–∞—Ä–∞—Ç–æ—Ä–æ–º")
        lines.append("‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ –ë–µ–∑ —Å–µ–ø–∞—Ä–∞—Ç–æ—Ä–∞")
        lines.append("‚îÇ       ‚îú‚îÄ‚îÄ –°—Ñ–µ—Ä–∏—á–µ—Å–∫–∏–µ (—Å–∞–º–æ—É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—â–∏–µ—Å—è)")
        lines.append("‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ –°–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–µ")
        lines.append("‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ –ê—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–µ")
        lines.append("‚îÇ       ‚îî‚îÄ‚îÄ –£–ø–æ—Ä–Ω—ã–µ —Ä–æ–ª–∏–∫–æ–≤—ã–µ")
        lines.append("‚îÇ")
        lines.append("‚îî‚îÄ‚îÄ –ü–û–î–®–ò–ü–ù–ò–ö–ò –°–ö–û–õ–¨–ñ–ï–ù–ò–Ø")
        lines.append("    ‚îú‚îÄ‚îÄ –í—Ç—É–ª–∫–∏")
        lines.append("    ‚îú‚îÄ‚îÄ –°—Ñ–µ—Ä–∏—á–µ—Å–∫–∏–µ —à–∞—Ä–Ω–∏—Ä–Ω—ã–µ")
        lines.append("    ‚îî‚îÄ‚îÄ –£–ø–æ—Ä–Ω—ã–µ —à–∞–π–±—ã")
        lines.append("```\n")
        
        lines.append("### 9.2. –°–≤—è–∑—å –º–µ–∂–¥—É —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º–∏\n")
        lines.append("| –ì–û–°–¢ | ISO | –û–ø–∏—Å–∞–Ω–∏–µ |")
        lines.append("|------|-----|----------|")
        lines.append("| –ì–û–°–¢ 520-2002 | ISO 15:1998 | –ü–æ–¥—à–∏–ø–Ω–∏–∫–∏ —à–∞—Ä–∏–∫–æ–≤—ã–µ —Ä–∞–¥–∏–∞–ª—å–Ω—ã–µ –æ–¥–Ω–æ—Ä—è–¥–Ω—ã–µ |")
        lines.append("| –ì–û–°–¢ 8338-75 | ISO 355:1977 | –ö–æ–Ω–∏—á–µ—Å–∫–∏–µ —Ä–æ–ª–∏–∫–æ–ø–æ–¥—à–∏–ø–Ω–∏–∫–∏ |")
        lines.append("| –ì–û–°–¢ 5721-75 | ISO 104:2002 | –û–±–æ–∑–Ω–∞—á–µ–Ω–∏—è –ø–æ–¥—à–∏–ø–Ω–∏–∫–æ–≤ |")
        lines.append("| –ì–û–°–¢ 24810-2013 | ISO 492:2014 | –ö–ª–∞—Å—Å—ã —Ç–æ—á–Ω–æ—Å—Ç–∏ |")
        lines.append("| –ì–û–°–¢ 24955-81 | ISO 5753:1991 | –ó–∞–∑–æ—Ä—ã |")
        
        lines.append("\n### 9.3. –í–∑–∞–∏–º–æ—Å–≤—è–∑—å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–æ–¥—à–∏–ø–Ω–∏–∫–∞\n")
        lines.append("```")
        lines.append("–¢–∏–ø–æ—Ä–∞–∑–º–µ—Ä –ø–æ–¥—à–∏–ø–Ω–∏–∫–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 6205)")
        lines.append("‚îÇ")
        lines.append("‚îú‚îÄ‚îÄ –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç:")
        lines.append("‚îÇ   ‚îú‚îÄ‚îÄ –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –¥–∏–∞–º–µ—Ç—Ä (d = 25 –º–º)")
        lines.append("‚îÇ   ‚îú‚îÄ‚îÄ –ù–∞—Ä—É–∂–Ω—ã–π –¥–∏–∞–º–µ—Ç—Ä (D = 52 –º–º)")
        lines.append("‚îÇ   ‚îú‚îÄ‚îÄ –®–∏—Ä–∏–Ω—É (B = 15 –º–º)")
        lines.append("‚îÇ   ‚îú‚îÄ‚îÄ –î–∏–Ω–∞–º–∏—á–µ—Å–∫—É—é –≥—Ä—É–∑–æ–ø–æ–¥—ä—ë–º–Ω–æ—Å—Ç—å (C)")
        lines.append("‚îÇ   ‚îî‚îÄ‚îÄ –°—Ç–∞—Ç–∏—á–µ—Å–∫—É—é –≥—Ä—É–∑–æ–ø–æ–¥—ä—ë–º–Ω–æ—Å—Ç—å (C0)")
        lines.append("‚îÇ")
        lines.append("‚îú‚îÄ‚îÄ –í–ª–∏—è–µ—Ç –Ω–∞:")
        lines.append("‚îÇ   ‚îú‚îÄ‚îÄ –í—ã–±–æ—Ä –ø–æ—Å–∞–¥–∫–∏ (–ø–æ d –∏ D)")
        lines.append("‚îÇ   ‚îú‚îÄ‚îÄ –†–∞—Å—á—ë—Ç –¥–æ–ª–≥–æ–≤–µ—á–Ω–æ—Å—Ç–∏ (–ø–æ C –∏ –Ω–∞–≥—Ä—É–∑–∫–µ)")
        lines.append("‚îÇ   ‚îú‚îÄ‚îÄ –ß–∞—Å—Ç–æ—Ç—É –≤—Ä–∞—â–µ–Ω–∏—è (–ø—Ä–µ–¥–µ–ª—å–Ω—É—é)")
        lines.append("‚îÇ   ‚îî‚îÄ‚îÄ –í—ã–±–æ—Ä —Å–º–∞–∑–∫–∏")
        lines.append("‚îÇ")
        lines.append("‚îî‚îÄ‚îÄ –ó–∞–≤–∏—Å–∏—Ç –æ—Ç:")
        lines.append("    ‚îú‚îÄ‚îÄ –£—Å–ª–æ–≤–∏–π —Ä–∞–±–æ—Ç—ã (–Ω–∞–≥—Ä—É–∑–∫–∞, —Å–∫–æ—Ä–æ—Å—Ç—å)")
        lines.append("    ‚îú‚îÄ‚îÄ –¢—Ä–µ–±—É–µ–º–æ–≥–æ —Ä–µ—Å—É—Ä—Å–∞")
        lines.append("    ‚îî‚îÄ‚îÄ –ö–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ —É–∑–ª–∞")
        lines.append("```\n")
        
        return '\n'.join(lines)
        
    def build_section_10_sources(self) -> str:
        """–†–∞–∑–¥–µ–ª 10: –ü–æ–ª–Ω–∞—è —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤"""
        lines = []
        lines.append("### 10.1. –ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤\n")
        lines.append("| ‚Ññ | –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É | –†–∞–∑–º–µ—Ä (—Å—Ç—Ä–æ–∫) | –†–∞–∑–¥–µ–ª |")
        lines.append("|---|--------------|----------------|--------|")
        
        for i, (path, content) in enumerate(sorted(self.all_files.items()), 1):
            line_count = len(content.split('\n'))
            section = path.split('/')[0]
            lines.append(f"| {i} | `{path}` | {line_count} | {section} |")
            
        lines.append(f"\n**–í—Å–µ–≥–æ —Ñ–∞–π–ª–æ–≤: {len(self.all_files)}**\n")
        
        lines.append("### 10.2. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ä–∞–∑–¥–µ–ª–∞–º\n")
        lines.append("| –†–∞–∑–¥–µ–ª | –§–∞–π–ª–æ–≤ | –°—Ç—Ä–æ–∫ |")
        lines.append("|--------|--------|-------|")
        
        section_stats = defaultdict(lambda: {'files': 0, 'lines': 0})
        for path, content in self.all_files.items():
            section = path.split('/')[0]
            section_stats[section]['files'] += 1
            section_stats[section]['lines'] += len(content.split('\n'))
            
        for section in sorted(section_stats.keys()):
            stats = section_stats[section]
            lines.append(f"| {section} | {stats['files']} | {stats['lines']:,} |")
            
        return '\n'.join(lines)
        
    def build(self) -> str:
        """–ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –ø–æ–ª–Ω–æ–π –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π"""
        print("="*80)
        print("–°–û–ó–î–ê–ù–ò–ï –£–õ–¨–¢–†–ê-–ö–û–ú–ü–õ–ï–ö–°–ù–û–ô –ë–ê–ó–´ –ó–ù–ê–ù–ò–ô")
        print("="*80)
        
        self.load_all_markdown_files()
        
        print("üìä –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö...")
        all_terms = self.extract_all_terms()
        all_tables = self.extract_all_tables()
        all_standards = self.extract_all_standards()
        
        print(f"‚úÖ –¢–µ—Ä–º–∏–Ω—ã: {len(all_terms):,}")
        print(f"‚úÖ –¢–∞–±–ª–∏—Ü—ã: {len(all_tables)}")
        print(f"‚úÖ –°—Ç–∞–Ω–¥–∞—Ä—Ç—ã: {len(all_standards)}\n")
        
        print("üìù –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–¥–µ–ª–æ–≤...")
        
        kb = []
        kb.append("# –ü–û–õ–ù–ê–Ø –ë–ê–ó–ê –ó–ù–ê–ù–ò–ô: BearingsInfo")
        kb.append(f"\n**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}")
        kb.append(f"**–í–µ—Ä—Å–∏—è:** 2.0 ULTRA COMPREHENSIVE")
        kb.append(f"\n**–†–ï–ñ–ò–ú: –ú–ê–ö–°–ò–ú–ê–õ–¨–ù–´–ô –ö–û–ù–¢–ï–ö–°–¢**")
        kb.append(f"–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ 100% –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –±–µ–∑ —Å–æ–∫—Ä–∞—â–µ–Ω–∏–π –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π\n")
        
        kb.append("## –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏")
        kb.append(f"- –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ —Ñ–∞–π–ª–æ–≤: **{self.stats['files']}**")
        kb.append(f"- –°—Ç—Ä–æ–∫ –∫–æ–Ω—Ç–µ–Ω—Ç–∞: **{self.stats['lines']:,}**")
        kb.append(f"- –ò–∑–≤–ª–µ—á–µ–Ω–æ —Ç–µ—Ä–º–∏–Ω–æ–≤: **{len(all_terms):,}**")
        kb.append(f"- –¢–∞–±–ª–∏—Ü –¥–∞–Ω–Ω—ã—Ö: **{len(all_tables)}**")
        kb.append(f"- –£–ø–æ–º–∏–Ω–∞–Ω–∏–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–≤: **{len(all_standards)}**\n")
        
        kb.append("---\n")
        kb.append("# üìë –°–û–î–ï–†–ñ–ê–ù–ò–ï\n")
        for i in range(1, 11):
            titles = [
                "–û–±—â–µ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –¥–æ–º–µ–Ω–∞",
                "–¢–µ—Ä–º–∏–Ω—ã –∏ –≥–ª–æ—Å—Å–∞—Ä–∏–π",
                "–ü—Ä–æ—Ü–µ—Å—Å—ã –∏ –∞–ª–≥–æ—Ä–∏—Ç–º—ã",
                "–ü—Ä–∞–≤–∏–ª–∞ –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è",
                "–°—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö –∏ —Ñ–æ—Ä–º–∞—Ç—ã",
                "–†–æ–ª–∏ –∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏",
                "–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∏ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è",
                "–û—à–∏–±–∫–∏, –∏—Å–∫–ª—é—á–µ–Ω–∏—è, –∫—Ä–∞–π–Ω–∏–µ —Å–ª—É—á–∞–∏",
                "–°–≤—è–∑–∏ –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É —Å—É—â–Ω–æ—Å—Ç—è–º–∏",
                "–ò—Å—Ç–æ—á–Ω–∏–∫–∏ –∏ —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞"
            ]
            kb.append(f"{i}. [{titles[i-1]}](#{i}-{titles[i-1].lower().replace(' ', '-').replace(',', '')})")
            
        kb.append("\n" + "="*80 + "\n")
        
        print("  –†–∞–∑–¥–µ–ª 1: –û–±—â–µ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –¥–æ–º–µ–Ω–∞")
        kb.append(f"\n## 1. –û–±—â–µ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –¥–æ–º–µ–Ω–∞\n")
        kb.append(self.build_section_1_domain())
        kb.append("\n" + "="*80 + "\n")
        
        print("  –†–∞–∑–¥–µ–ª 2: –¢–µ—Ä–º–∏–Ω—ã –∏ –≥–ª–æ—Å—Å–∞—Ä–∏–π")
        kb.append(f"\n## 2. –¢–µ—Ä–º–∏–Ω—ã –∏ –≥–ª–æ—Å—Å–∞—Ä–∏–π\n")
        kb.append(self.build_section_2_terms(all_terms))
        kb.append("\n" + "="*80 + "\n")
        
        print("  –†–∞–∑–¥–µ–ª 3: –ü—Ä–æ—Ü–µ—Å—Å—ã –∏ –∞–ª–≥–æ—Ä–∏—Ç–º—ã")
        kb.append(f"\n## 3. –ü—Ä–æ—Ü–µ—Å—Å—ã –∏ –∞–ª–≥–æ—Ä–∏—Ç–º—ã\n")
        kb.append(self.build_section_3_processes())
        kb.append("\n" + "="*80 + "\n")
        
        print("  –†–∞–∑–¥–µ–ª 4: –ü—Ä–∞–≤–∏–ª–∞ –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è")
        kb.append(f"\n## 4. –ü—Ä–∞–≤–∏–ª–∞ –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è\n")
        kb.append(self.build_section_4_rules(all_standards))
        kb.append("\n" + "="*80 + "\n")
        
        print("  –†–∞–∑–¥–µ–ª 5: –°—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö –∏ —Ñ–æ—Ä–º–∞—Ç—ã")
        kb.append(f"\n## 5. –°—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö –∏ —Ñ–æ—Ä–º–∞—Ç—ã\n")
        kb.append(self.build_section_5_data_structures(all_tables))
        kb.append("\n" + "="*80 + "\n")
        
        print("  –†–∞–∑–¥–µ–ª 6: –†–æ–ª–∏ –∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏")
        kb.append(f"\n## 6. –†–æ–ª–∏ –∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏\n")
        kb.append(self.build_section_6_roles())
        kb.append("\n" + "="*80 + "\n")
        
        print("  –†–∞–∑–¥–µ–ª 7: –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∏ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è")
        kb.append(f"\n## 7. –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∏ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è\n")
        kb.append(self.build_section_7_usage())
        kb.append("\n" + "="*80 + "\n")
        
        print("  –†–∞–∑–¥–µ–ª 8: –û—à–∏–±–∫–∏, –∏—Å–∫–ª—é—á–µ–Ω–∏—è, –∫—Ä–∞–π–Ω–∏–µ —Å–ª—É—á–∞–∏")
        kb.append(f"\n## 8. –û—à–∏–±–∫–∏, –∏—Å–∫–ª—é—á–µ–Ω–∏—è, –∫—Ä–∞–π–Ω–∏–µ —Å–ª—É—á–∞–∏\n")
        kb.append(self.build_section_8_errors())
        kb.append("\n" + "="*80 + "\n")
        
        print("  –†–∞–∑–¥–µ–ª 9: –°–≤—è–∑–∏ –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏")
        kb.append(f"\n## 9. –°–≤—è–∑–∏ –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É —Å—É—â–Ω–æ—Å—Ç—è–º–∏\n")
        kb.append(self.build_section_9_relationships())
        kb.append("\n" + "="*80 + "\n")
        
        print("  –†–∞–∑–¥–µ–ª 10: –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –∏ —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞")
        kb.append(f"\n## 10. –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –∏ —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞\n")
        kb.append(self.build_section_10_sources())
        
        return '\n'.join(kb)

def main():
    builder = UltraComprehensiveKB()
    kb_content = builder.build()
    
    output_file = "KNOWLEDGE_BASE_COMPLETE.md"
    with open(output_file, 'w', encoding='utf-8') as f:
        f.write(kb_content)
        
    file_size = os.path.getsize(output_file)
    line_count = len(kb_content.split('\n'))
    
    print("\n" + "="*80)
    print("‚úÖ –ë–ê–ó–ê –ó–ù–ê–ù–ò–ô –£–°–ü–ï–®–ù–û –°–û–ó–î–ê–ù–ê")
    print("="*80)
    print(f"üìÑ –§–∞–π–ª: {output_file}")
    print(f"üì¶ –†–∞–∑–º–µ—Ä: {file_size:,} –±–∞–π—Ç ({file_size/1024/1024:.2f} –ú–ë)")
    print(f"üìä –°—Ç—Ä–æ–∫: {line_count:,}")
    print(f"üìÅ –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ —Ñ–∞–π–ª–æ–≤: {builder.stats['files']}")
    print("="*80)

if __name__ == "__main__":
    main()
