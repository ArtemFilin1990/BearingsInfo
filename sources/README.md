# Источники данных / Data Sources

Эта директория содержит исходные данные, скрипты для их сбора и документацию по источникам информации.

## Содержание

### Скрипты
- **aprom_table_scraper.py** - Скрипт для загрузки таблиц с сайта aprom.by
  - Поддерживает автоматические повторные попытки при сетевых ошибках
  - Настраиваемые параметры через CLI или переменные окружения
  - Независим от внешних зависимостей (только stdlib)
  - См. `python aprom_table_scraper.py --help` для деталей

### Данные
- **aprom_brands.json** - База производителей подшипников (284 записи)
  - Источник: [aprom.by/brands.php](https://aprom.by/brands.php)
  - Дата выгрузки: 2025-12-28
  - Схема данных: см. `aprom_brands_schema.json`

- **aprom_brands_schema.json** - JSON Schema для расширенной базы производителей
  - Определяет структуру данных для информации о брендах
  - Поддерживает дополнительные поля: категория, сайт, сертификации

### Документация источников
- **literature.md** - Список литературы и стандартов
- **online_catalogs.md** - Онлайн-каталоги производителей
- **offline_catalog_snapshots.md** - Документация по локальным копиям каталогов
- **RAW_INDEX.md** - Индекс сырых данных и выгрузок

### Каталоги производителей
Директория `vendor_catalogs/` содержит описания и метаданные каталогов:
- Обзоры структуры каталогов
- Снимки состояния онлайн-каталогов
- Методики извлечения данных

## Использование скрипта aprom_table_scraper.py

### Базовое использование
```bash
python sources/aprom_table_scraper.py --output sources/aprom_table_data.json
```

### С настройкой повторных попыток
```bash
python sources/aprom_table_scraper.py \
    --output sources/aprom_table_data.json \
    --max-retries 5 \
    --retry-delay 3.0 \
    --verbose
```

### Через переменные окружения
```bash
export APROM_MAX_RETRIES=5
export APROM_RETRY_DELAY=3.0
export HTTP_TIMEOUT_SECONDS=15
python sources/aprom_table_scraper.py --output sources/aprom_table_data.json
```

### Параметры
- `--url` - URL для загрузки (по умолчанию: https://aprom.by/table.php)
- `--output` - Путь для сохранения JSON
- `--timeout` - Таймаут запроса в секундах
- `--delay` - Задержка между запросами
- `--max-pages` - Максимальное количество страниц
- `--max-retries` - Максимальное количество повторных попыток
- `--retry-delay` - Задержка между повторными попытками
- `-v, --verbose` - Увеличить детализацию логов

## Тестирование

Запуск unit-тестов для скрипта:
```bash
python tests/test_aprom_scraper.py
```

Или с pytest:
```bash
python -m pytest tests/test_aprom_scraper.py -v
```

## Версионирование источников

При обновлении каталогов производителей рекомендуется:

1. Сохранять дату получения данных
2. Указывать версию каталога или дату публикации
3. Вычислять контрольную сумму файлов
4. Документировать изменения в changelog

Пример метаданных:
```json
{
  "source": "aprom.by/brands.php",
  "retrieved_at": "2025-12-28T18:00:00Z",
  "checksum_sha256": "...",
  "version": "2025-12-28",
  "record_count": 284
}
```

## Вклад в источники

При добавлении новых источников:

1. Документируйте источник в соответствующем .md файле
2. Указывайте точную ссылку и дату доступа
3. Для PDF/каталогов указывайте версию и издателя
4. Сохраняйте исходные данные в неизменном виде
5. Скрипты обработки храните отдельно от данных

## Стандарты качества

Все данные должны:
- ✅ Иметь указание источника
- ✅ Включать дату получения/проверки
- ✅ Соответствовать структуре репозитория
- ✅ Быть проверяемыми (ссылки доступны, версии указаны)

---

**Последнее обновление**: 2025-12-28
